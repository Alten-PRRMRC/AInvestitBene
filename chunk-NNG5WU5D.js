import{a as b}from"./chunk-BW5CA5VS.js";import{H as g,M as x,R as l,e as a,i as c,p,q as v}from"./chunk-354CNLSK.js";var S=["fashion","groceries","cryptocurrency"],u=[...S];var E=class r{STORAGE_KEY="expenses";_expenseList$;_localStorageService=l(b);constructor(){let e=this._localStorageService.getItem(this.STORAGE_KEY)||[];this._expenseList$=new c(e)}addItem(e){let s=[...this._expenseList$.getValue(),e];this._expenseList$.next(s),this.saveToLocalStorage(s)}get expenseList$(){return this._expenseList$}updateItem(e){let s=this._expenseList$.getValue().map(n=>n.id===e.id?e:n);this._expenseList$.next(s),this.saveToLocalStorage(s)}deleteItem(e){let s=this._expenseList$.getValue().filter(n=>n.id!==e);this._expenseList$.next(s),this.saveToLocalStorage(s)}getById(e){return e?this._expenseList$.getValue().find(t=>t.id===e):void 0}get categories(){return u}getExpenses$(e,t,s,n){let i=v([t,e]).pipe(p(([o,m])=>n(o,m)));return v([i,s]).pipe(this.list_map())}getExpensesKey$(e,t){return v([e,t]).pipe(this.list_map()).pipe(p(n=>{let i=Object.keys(n);return t.value?i.sort((o,m)=>+m-+o):i.sort((o,m)=>new Date(o).getTime()-new Date(m).getTime())}))}getExpensesTotalImport$(e){return e.pipe(p(t=>{let s={};for(let n in t)s[n]=t[n].reduce((i,o)=>i+o.import,0);return s}))}list_map(){return p(([e,t])=>{let s={};for(let n=0;n<e.length;n++){let i=this.getGroupKey(e[n],t);s[i]||(s[i]=[]),s[i].push(e[n])}return s})}getGroupKey(e,t){return t?e.date.getFullYear().toString():e.date.toLocaleString("default",{month:"long"})}saveToLocalStorage(e){this._localStorageService.setItem(this.STORAGE_KEY,e)}ngOnDestroy(){this._expenseList$.complete()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=x({token:r,factory:r.\u0275fac,providedIn:"root"})};var f=class r{expensesFiltered$=new a;expensesFilteredKey$=new a;expenseService=l(E);expenseItems$=this.expenseService.expenseList$;expensesTotal$=new a;filterFn=(e,t)=>e==="all"?t:t.filter(s=>s.category===e);initialize(e,t){this.expensesFiltered$=this.expenseService.getExpenses$(this.expenseItems$,e,t,this.filterFn),this.expensesFilteredKey$=this.expensesFiltered$.pipe(p(s=>Object.values(s).flat()),g(s=>this.expenseService.getExpensesKey$(new c(s),t))),this.expensesTotal$=this.expenseService.getExpensesTotalImport$(this.expensesFiltered$)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=x({token:r,factory:r.\u0275fac,providedIn:"root"})};var h=class r{expenseService=l(E);filteredExpenses$=new a;expensesFilteredKey$=new a;expenseItems$=this.expenseService.expenseList$;filterFn=(e,t)=>{if(e.length===0)return t;let s=t.filter(n=>n.description.toLowerCase().replace(/\s/g,"").includes(e));return s.length===0?t:s};initialize(e,t){this.filteredExpenses$=this.expenseService.getExpenses$(this.expenseItems$,e,t,this.filterFn),this.expensesFilteredKey$=this.filteredExpenses$.pipe(p(s=>Object.values(s).flat()),g(s=>this.expenseService.getExpensesKey$(new c(s),t)))}deleteExpense(e){this.expenseService.deleteItem(e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=x({token:r,factory:r.\u0275fac,providedIn:"root"})};export{E as a,h as b,f as c};
