import{b as B,c as p,d as X,e as Y,f as $,g as x,h as z,i as H,k as J,l as K,m as Q,n as U,o as Z,p as ee,q as te}from"./chunk-M6CCHBBN.js";import{a as ne}from"./chunk-3UN3RL46.js";import"./chunk-WIUYRXXV.js";import{b as O,d as W,e as j}from"./chunk-O3BENMIO.js";import{Kb as S,Mb as R,Na as s,Oa as m,Ob as G,Qa as V,R as v,Ra as N,Sa as T,Ta as u,Ua as r,Va as i,W as F,Wa as C,X as w,_a as q,a as E,ab as D,b as I,cb as _,jb as a,kb as A,lb as h,mb as y,nb as g,ob as f,qb as M,ra as o,sb as k,tb as P,za as L}from"./chunk-E5YAWDRL.js";var re=()=>["/"];function le(t,n){t&1&&(r(0,"span"),a(1,"Description is required"),i())}function ae(t,n){if(t&1&&(r(0,"span"),a(1),i()),t&2){_(2);let e=f(12);o(),h("Description must be at least ",e==null||e.errors==null?null:e.errors.minlength.requiredLength," characters")}}function se(t,n){if(t&1&&(r(0,"section",8),s(1,le,2,0,"span"),s(2,ae,2,1,"span"),i()),t&2){_();let e=f(12);o(),m(!(e==null||e.errors==null)&&e.errors.required||!(e==null||e.errors==null)&&e.errors.noWhitespace?1:-1),o(),m(!(e==null||e.errors==null)&&e.errors.minlength&&!(!(e==null||e.errors==null)&&e.errors.noWhitespace)?2:-1)}}function me(t,n){t&1&&(r(0,"span"),a(1,"Amount is required"),i())}function ce(t,n){t&1&&(r(0,"span"),a(1,"Amount must be positive"),i())}function pe(t,n){if(t&1&&(r(0,"section",8),s(1,me,2,0,"span"),s(2,ce,2,0,"span"),i()),t&2){_();let e=f(19);o(),m(!(e==null||e.errors==null)&&e.errors.required?1:-1),o(),m(!(e==null||e.errors==null)&&e.errors.min?2:-1)}}function de(t,n){if(t&1&&(r(0,"option",13),a(1),k(2,"titlecase"),i()),t&2){let e=n.$implicit;u("value",e),o(),h(" ",P(2,2,e)," ")}}function ue(t,n){t&1&&(r(0,"span"),a(1,"Date is required"),i())}function _e(t,n){if(t&1&&(r(0,"section",8),s(1,ue,2,0,"span"),i()),t&2){_();let e=f(33);o(),m(!(e==null||e.errors==null)&&e.errors.required?1:-1)}}function fe(t){return t.value.trim().length===0?{noWhitespace:!0}:null}var ie=class t{labels={subtitle:"Add new import",description:"Enter import description",submit:"Save import"};_isIncome=!1;_expenseService=v(ne);_route=v(O);_router=v(W);_formDirty=!1;_currentExpense;expenseForm=new $({description:new x("",[p.required,p.minLength(2),fe]),import:new x(1,[p.required,p.min(1)]),category:new x(this._expenseService.categories[0],[p.required]),date:new x(S(Date.now(),"yyyy-MM-dd","en"),[p.required])});ngOnInit(){this.expenseForm.valueChanges.subscribe(()=>{this._formDirty=this.expenseForm.dirty});let n=this._route.snapshot.queryParams,e=n.id||void 0;this._isIncome=n.isIncome==="true";let l=this._expenseService.getById(e);this._currentExpense=l?E({},l):void 0,this._currentExpense&&(this._isIncome=this._currentExpense.import>=0,this._currentExpense.import*=this._isIncome?1:-1),this.labels=this._isIncome?this.labels:{subtitle:"Add new export",description:"Enter export description",submit:"Save export"},this.resetForm(this._currentExpense)}onSubmit(){if(!this.expenseForm.valid)return;let n=I(E({id:this._currentExpense?.id||Date.now().toString()},this.expenseForm.value),{date:new Date(this.expenseForm.value.date),import:this.expenseForm.value.import*(this._isIncome?1:-1)});this._currentExpense?this._expenseService.updateItem(n):this._expenseService.addItem(n),this._formDirty=!1,this._router.navigate(["/"])}resetForm(n){let e={description:"",import:1,category:this._expenseService.categories[0],date:S(Date.now(),"yyyy-MM-dd","en")},l=n?{description:n.description,import:n.import,category:n.category,date:S(n.date,"yyyy-MM-dd","en")}:e;this.expenseForm.reset(l),this._formDirty=!1}canDeactivate(){return this._formDirty?new Promise(n=>{let e=window.confirm("You have unsaved changes. Do you really want to leave?");n(e)}):!0}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=L({type:t,selectors:[["expense-form"]],decls:40,vars:13,consts:[[1,"p-6","max-w-xl","mx-auto","bg-base-100","rounded-lg","shadow-md"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-base-content"],[1,"btn","btn-sm","btn-outline","btn-error",3,"routerLink"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","description",1,"label"],[1,"label-text"],["type","text","id","description","formControlName","description",1,"input","input-bordered","w-full","focus:outline-none",3,"placeholder"],[1,"bg-error","text-error-content","rounded-full","text-sm","mt-1"],["for","import",1,"label"],["type","number","id","import","formControlName","import","min","1","step","1",1,"input","input-bordered","w-full","focus:outline-none"],["for","category",1,"label"],["id","category","formControlName","category",1,"select","select-bordered","w-full","focus:outline-none"],[3,"value"],["for","date",1,"label"],["type","date","id","date","formControlName","date",1,"input","input-bordered","w-full","focus:outline-none"],[1,"flex","justify-end","gap-4","pt-4"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-outline","btn-error",3,"click"]],template:function(e,l){if(e&1){let c=q();r(0,"section",0)(1,"section",1)(2,"h2",2),a(3),i(),r(4,"a",3),a(5,"X"),i()(),r(6,"form",4),D("ngSubmit",function(){return F(c),w(l.onSubmit())}),r(7,"section")(8,"label",5)(9,"span",6),a(10,"Description"),i()(),C(11,"input",7),y(12),s(13,se,3,2,"section",8),i(),r(14,"section")(15,"label",9)(16,"span",6),a(17,"Amount"),i()(),C(18,"input",10),y(19),s(20,pe,3,2,"section",8),i(),r(21,"section")(22,"label",11)(23,"span",6),a(24,"Category"),i()(),r(25,"select",12),N(26,de,3,4,"option",13,V),i()(),r(28,"section")(29,"label",14)(30,"span",6),a(31,"Date"),i()(),C(32,"input",15),y(33),s(34,_e,2,1,"section",8),i(),r(35,"section",16)(36,"button",17),a(37),i(),r(38,"button",18),D("click",function(){return F(c),w(l.resetForm())}),a(39," Reset "),i()()()()}if(e&2){o(3),A(l.labels.subtitle),o(),u("routerLink",M(12,re)),o(2),u("formGroup",l.expenseForm),o(5),u("placeholder",l.labels.description),o();let c=g(l.expenseForm.get("description"));o(),m(c!=null&&c.invalid&&(c!=null&&c.touched)?13:-1),o(6);let d=g(l.expenseForm.get("import"));o(),m(d!=null&&d.invalid&&(d!=null&&d.touched)?20:-1);let oe=l._expenseService.categories;o(6),T(oe),o(7);let b=g(l.expenseForm.get("date"));o(),m(b!=null&&b.invalid&&(b!=null&&b.touched)?34:-1),o(2),u("disabled",l.expenseForm.invalid),o(),h(" ",l.labels.submit," ")}},dependencies:[G,te,z,U,Z,B,H,Q,X,Y,ee,J,K,j,R],encapsulation:2})};export{ie as FormComponent};
