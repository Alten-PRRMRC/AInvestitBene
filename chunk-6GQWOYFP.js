import{b as j,c,d as B,e as X,f as Y,g as x,h as $,i as z,k as H,l as J,m as K,n as Q,o as U,p as Z,q as ee}from"./chunk-XS3JX4OT.js";import{a as te}from"./chunk-2QQ7Q7FA.js";import"./chunk-BW5CA5VS.js";import{b as G,d as M,e as W}from"./chunk-A7XXGE3Z.js";import{Mb as P,Na as p,Oa as u,Ob as R,Qa as T,R as v,Ra as L,Sa as V,Ta as d,Ua as r,Va as i,W as y,Wa as C,X as F,_a as N,a as E,ab as w,b as I,cb as f,jb as a,kb as q,lb as h,mb as g,nb as S,ob as _,qb as A,ra as o,sb as k,tb as O,za as D}from"./chunk-354CNLSK.js";var oe=()=>["/"];function re(t,n){t&1&&(r(0,"span"),a(1,"Description is required"),i())}function le(t,n){if(t&1&&(r(0,"span"),a(1),i()),t&2){f(2);let e=_(12);o(),h("Description must be at least ",e==null||e.errors==null?null:e.errors.minlength.requiredLength," characters")}}function ae(t,n){if(t&1&&(r(0,"section",8),p(1,re,2,0,"span"),p(2,le,2,1,"span"),i()),t&2){f();let e=_(12);o(),u(!(e==null||e.errors==null)&&e.errors.required||!(e==null||e.errors==null)&&e.errors.noWhitespace?1:-1),o(),u(!(e==null||e.errors==null)&&e.errors.minlength&&!(!(e==null||e.errors==null)&&e.errors.noWhitespace)?2:-1)}}function se(t,n){t&1&&(r(0,"span"),a(1,"Amount is required"),i())}function me(t,n){t&1&&(r(0,"span"),a(1,"Amount must be positive"),i())}function pe(t,n){if(t&1&&(r(0,"section",8),p(1,se,2,0,"span"),p(2,me,2,0,"span"),i()),t&2){f();let e=_(19);o(),u(!(e==null||e.errors==null)&&e.errors.required?1:-1),o(),u(!(e==null||e.errors==null)&&e.errors.min?2:-1)}}function ue(t,n){if(t&1&&(r(0,"option",13),a(1),k(2,"titlecase"),i()),t&2){let e=n.$implicit;d("value",e),o(),h(" ",O(2,2,e)," ")}}function ce(t,n){t&1&&(r(0,"span"),a(1,"Date is required"),i())}function de(t,n){if(t&1&&(r(0,"section",8),p(1,ce,2,0,"span"),i()),t&2){f();let e=_(33);o(),u(!(e==null||e.errors==null)&&e.errors.required?1:-1)}}function fe(t){return t.value.trim().length===0?{noWhitespace:!0}:null}var ne=class t{labels;_isIncome=!1;_expenseService=v(te);_route=v(G);_router=v(M);_formDirty=!1;_currentExpense;expenseForm=new Y({description:new x("",[c.required,c.minLength(2),fe]),import:new x(1,[c.required,c.min(1)]),category:new x([],[c.required]),date:new x("",[c.required])});ngOnInit(){let n={subtitle:"Add new import",description:"Enter import description",submit:"Save import"},e={subtitle:"Add new export",description:"Enter export description",submit:"Save export"};this.expenseForm.valueChanges.subscribe(()=>{this._formDirty=this.expenseForm.dirty});let l=this._route.snapshot.queryParams,s=l.id||void 0;this._isIncome=l.isIncome==="true";let m=this._expenseService.getById(s);this._currentExpense=m?E({},m):void 0,this._currentExpense&&(this._isIncome=this._currentExpense.import>=0,this._currentExpense.import*=this._isIncome?1:-1),this.labels=this._isIncome?n:e,this.resetForm(this._currentExpense)}onSubmit(){if(!this.expenseForm.valid)return;let n=I(E({id:this._currentExpense?.id||Date.now().toString()},this.expenseForm.value),{date:new Date(this.expenseForm.value.date),import:this.expenseForm.value.import*(this._isIncome?1:-1)});this._currentExpense?this._expenseService.updateItem(n):this._expenseService.addItem(n),this._formDirty=!1,this._router.navigate(["/"])}resetForm(n){let e=new Date().toISOString().split("T")[0],l={description:"",import:1,category:this._expenseService.categories[0],date:e},s=n?{description:n.description,import:n.import,category:n.category,date:n.date.toISOString().split("T")[0]}:l;this.expenseForm.reset(s),this._formDirty=!1}canDeactivate(){return this._formDirty?new Promise(n=>{let e=window.confirm("You have unsaved changes. Do you really want to leave?");n(e)}):!0}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=D({type:t,selectors:[["expense-form"]],decls:40,vars:13,consts:[[1,"p-6","max-w-xl","mx-auto","bg-base-100","rounded-lg","shadow-md"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-base-content"],[1,"btn","btn-sm","btn-outline","btn-error",3,"routerLink"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","description",1,"label"],[1,"label-text"],["type","text","id","description","formControlName","description",1,"input","input-bordered","w-full","focus:outline-none",3,"placeholder"],[1,"bg-error","text-error-content","rounded-full","text-sm","mt-1"],["for","import",1,"label"],["type","number","id","import","formControlName","import","min","1","step","1",1,"input","input-bordered","w-full","focus:outline-none"],["for","category",1,"label"],["id","category","formControlName","category",1,"select","select-bordered","w-full","focus:outline-none"],[3,"value"],["for","date",1,"label"],["type","date","id","date","formControlName","date",1,"input","input-bordered","w-full","focus:outline-none"],[1,"flex","justify-end","gap-4","pt-4"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-outline","btn-error",3,"click"]],template:function(e,l){if(e&1){let s=N();r(0,"section",0)(1,"section",1)(2,"h2",2),a(3),i(),r(4,"a",3),a(5,"X"),i()(),r(6,"form",4),w("ngSubmit",function(){return y(s),F(l.onSubmit())}),r(7,"section")(8,"label",5)(9,"span",6),a(10,"Description"),i()(),C(11,"input",7),g(12),p(13,ae,3,2,"section",8),i(),r(14,"section")(15,"label",9)(16,"span",6),a(17,"Amount"),i()(),C(18,"input",10),g(19),p(20,pe,3,2,"section",8),i(),r(21,"section")(22,"label",11)(23,"span",6),a(24,"Category"),i()(),r(25,"select",12),L(26,ue,3,4,"option",13,T),i()(),r(28,"section")(29,"label",14)(30,"span",6),a(31,"Date"),i()(),C(32,"input",15),g(33),p(34,de,2,1,"section",8),i(),r(35,"section",16)(36,"button",17),a(37),i(),r(38,"button",18),w("click",function(){return y(s),F(l.resetForm())}),a(39," Reset "),i()()()()}if(e&2){o(3),q(l.labels==null?null:l.labels.subtitle),o(),d("routerLink",A(12,oe)),o(2),d("formGroup",l.expenseForm),o(5),d("placeholder",l.labels==null?null:l.labels.description),o();let s=S(l.expenseForm.get("description"));o(),u(s!=null&&s.invalid&&(s!=null&&s.touched)?13:-1),o(6);let m=S(l.expenseForm.get("import"));o(),u(m!=null&&m.invalid&&(m!=null&&m.touched)?20:-1);let ie=l._expenseService.categories;o(6),V(ie),o(7);let b=S(l.expenseForm.get("date"));o(),u(b!=null&&b.invalid&&(b!=null&&b.touched)?34:-1),o(2),d("disabled",l.expenseForm.invalid),o(),h(" ",l.labels==null?null:l.labels.submit," ")}},dependencies:[R,ee,$,Q,U,j,z,K,B,X,Z,H,J,W,P],encapsulation:2})};export{ne as FormComponent};
